"use strict";(function(){var map={"react":"React","react-dom":"ReactDOM","react-cross-component-state":"createSharedState","react-bootstrap":"ReactBootstrap"};var exports={};var modules={"/src/App.jsx":function _src_AppJsx(require,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var _react=_interopRequireDefault(require("react"));var _reactDom=_interopRequireDefault(require("react-dom"));require("/src/App.less");var _store2=_interopRequireWildcard(require("/src/store.js"));var _store=_store2;var api=_interopRequireWildcard(require("/src/api.js"));var _index=require("/src/utils/index.js");var _reactBootstrap=require("react-bootstrap");function _interopRequireWildcard(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(_interopRequireWildcard=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;var o,i,f={__proto__:null,"default":e};if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return f;if(o=t?n:r){if(o.has(e))return o.get(e);o.set(e,f)}for(var _t in e)"default"!==_t&&{}.hasOwnProperty.call(e,_t)&&((i=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,_t))&&(i.get||i.set)?o(f,_t,i):f[_t]=e[_t]);return f})(e,t)}function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _regenerator(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}_store.initStore();function App(props){_store.useAutoSave();_store.useWideScreenChange();return/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,/*#__PURE__*/_react["default"].createElement(StatusBar,null),[/*#__PURE__*/_react["default"].createElement(ChatPanel,null),/*#__PURE__*/_react["default"].createElement(SettingPanel,null),/*#__PURE__*/_react["default"].createElement(HistoryPanel,null)][_store2.store.activeTabIdx.useValue()],/*#__PURE__*/_react["default"].createElement(Dialog,null))}function StatusBar(props){var _store$activeTabIdx$u=_store2.store.activeTabIdx.use(),_store$activeTabIdx$u2=_slicedToArray(_store$activeTabIdx$u,2),activeTabIdx=_store$activeTabIdx$u2[0],set_activeTabIdx=_store$activeTabIdx$u2[1];var historyCount=_store.useHistoryCount();var about=_store2.store.about;return/*#__PURE__*/_react["default"].createElement("div",{className:"statusbar-box"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Nav,{className:"statusbar",variant:"tabs",defaultActiveKey:activeTabIdx},[/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,/*#__PURE__*/_react["default"].createElement("i",{"class":"bi bi-person-workspace"}),"Chat"),/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,/*#__PURE__*/_react["default"].createElement("i",{"class":"bi bi-gear-fill"}),"Setting"),/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,/*#__PURE__*/_react["default"].createElement("i",{"class":"bi bi-clipboard2-fill"}),"History",historyCount>0&&/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Badge,{variant:"info",className:"history-count"},historyCount))].map(function(txt,idx){return/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Nav.Item,{key:idx,onClick:function onClick(_){set_activeTabIdx(idx)}},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Nav.Link,{eventKey:idx},txt))})),about&&/*#__PURE__*/_react["default"].createElement("i",{onClick:function onClick(_){_store2.store.dialogData.setValue({show:true,title:"About",large:true,content:/*#__PURE__*/_react["default"].createElement("div",{className:"about-content md-text",dangerouslySetInnerHTML:{__html:(0,_index.markdown)(about)}})})},className:"about-btn btn btn-sm btn-secondary bi bi-question-lg"}))}function confirmModal(title){return new Promise(function(resolve){_store2.store.dialogData.setValue({show:true,title:title,onConfirm:resolve,cancelButton:true})})}function Dialog(){var _store$dialogData$use=_store2.store.dialogData.use(),_store$dialogData$use2=_slicedToArray(_store$dialogData$use,2),dialogData=_store$dialogData$use2[0],set_dialogData=_store$dialogData$use2[1];var onConfirm=dialogData.onConfirm,title=dialogData.title,show=dialogData.show,content=dialogData.content,cancelButton=dialogData.cancelButton,large=dialogData.large;function closeDialog(){set_dialogData(_objectSpread(_objectSpread({},dialogData),{},{show:false}));onConfirm===null||onConfirm===void 0||onConfirm(false)}return/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Modal,{show:show,onHide:closeDialog,size:large?"lg":"md",className:"modal-textarea"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Modal.Header,{closeButton:true},title&&/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Modal.Title,null,title)),content?/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Modal.Body,null,content):null,onConfirm?/*#__PURE__*/_react["default"].createElement("div",{className:"modal-footer"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"primary",size:"md",onClick:function onClick(_){onConfirm(true);closeDialog()}},"OK")," ",cancelButton?/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"secondary",size:"md",onClick:function onClick(_){closeDialog()}},"Cancel"):null):null)}function Summary(_ref){var placeHolder=_ref.placeHolder,title=_ref.title,value=_ref.value,onChange=_ref.onChange;var Textarea=function Textarea(props){var _React$useState=_react["default"].useState(props.value),_React$useState2=_slicedToArray(_React$useState,2),value=_React$useState2[0],set_value=_React$useState2[1];return/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Control,{value:value,onChange:function onChange(e){var v=e.target.value;set_value(v);props.onChange(v)},as:"textarea",rows:6,placeHolder:props.placeHolder})};return/*#__PURE__*/_react["default"].createElement("div",{className:"summary",onClick:function onClick(_){_store2.store.dialogData.setValue({show:true,title:title,large:true,content:/*#__PURE__*/_react["default"].createElement(Textarea,{value:value,onChange:onChange})})}},value)}function SettingPanel(props){var _store$apiKey$use=_store2.store.apiKey.use(),_store$apiKey$use2=_slicedToArray(_store$apiKey$use,2),apiKey=_store$apiKey$use2[0],set_apiKey=_store$apiKey$use2[1];var ApiKey=/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Group,null,/*#__PURE__*/_react["default"].createElement("div",{className:"apikey-config"},(0,_index.isLocalServer)()?/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Check,{className:"checker",type:"switch",id:"apiKey-switch",label:"Use online api",checked:apiKey.enable,onChange:function onChange(e){set_apiKey(_objectSpread(_objectSpread({},apiKey),{},{enable:e.target.checked}))}}):/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,"Api key",/*#__PURE__*/_react["default"].createElement("a",{target:"_blank",href:"https://ollama.com/settings/keys"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Badge,{className:"apply-key",variant:"primary"},"apply new key")))),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Control,{value:apiKey.value,onChange:function onChange(e){return set_apiKey(_objectSpread(_objectSpread({},apiKey),{},{value:e.target.value}))},className:(0,_index.cls)("custom-input",apiKey.enable?"":"hide"),as:"input",placeHolder:"apiKey"}));var _store$prompt$use=_store2.store.prompt.use(),_store$prompt$use2=_slicedToArray(_store$prompt$use,2),prompt=_store$prompt$use2[0],set_prompt=_store$prompt$use2[1];var SystemPrompt=/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Group,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Label,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Check,{type:"switch",id:"system-prompt-switch",label:"Use System prompt",checked:prompt.enable,onChange:function onChange(e){set_prompt(_objectSpread(_objectSpread({},prompt),{},{enable:e.target.checked}))}})),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Group,{className:(0,_index.cls)("custom-input",prompt.enable?"":"hide")},/*#__PURE__*/_react["default"].createElement(Summary,{placeHolder:"System prompt",title:"System prompt",value:prompt.value,onChange:function onChange(v){set_prompt(_objectSpread(_objectSpread({},prompt),{},{value:v}))}})));var _store$contextLength$=_store2.store.contextLength.use(),_store$contextLength$2=_slicedToArray(_store$contextLength$,2),contextLength=_store$contextLength$2[0],set_contextLength=_store$contextLength$2[1];var ContextLength=/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Group,{controlId:"contextLengthRange"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Label,{className:"range-input"},"Context length: ",Math.round(contextLength/1024),"k",/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Control,{type:"range",custom:true,value:Math.round(contextLength/1024),min:8,step:4,max:128,onChange:function onChange(e){set_contextLength(Math.round(e.target.value*1024))}})));var _store$temperature$us=_store2.store.temperature.use(),_store$temperature$us2=_slicedToArray(_store$temperature$us,2),temperature=_store$temperature$us2[0],set_temperature=_store$temperature$us2[1];var Temperature=/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Group,{controlId:"temperatureRange"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Label,{className:"range-input"},"Temperature: ",temperature,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Control,{type:"range",custom:true,value:temperature,min:0,step:.1,max:2,onChange:function onChange(e){set_temperature(e.target.value)}})));var _store$model$use=_store2.store.model.use(),_store$model$use2=_slicedToArray(_store$model$use,2),model=_store$model$use2[0],set_model=_store$model$use2[1];var Model=/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Group,{controlId:"model"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Label,null,"Select model"),model.isLoading?/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"light",className:"loading-model btn-sm",disabled:true},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Spinner,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"}),"Loading..."):/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Control,{as:"select",custom:true,value:model.idx,disabled:model.isError,onChange:function onChange(e){_store.selectModel(e.target.value)}},model.names.length?model.names.map(function(name,idx){return/*#__PURE__*/_react["default"].createElement("option",{value:idx},name)}):/*#__PURE__*/_react["default"].createElement("option",null,"- No model -")));var _store$customPrompt$u=_store2.store.customPrompt.use(),_store$customPrompt$u2=_slicedToArray(_store$customPrompt$u,2),customPrompt=_store$customPrompt$u2[0],set_customPrompt=_store$customPrompt$u2[1];var CustomPrompt=/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Group,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Label,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Check,{type:"switch",id:"custom-switch-1",label:"Use preset prompt",checked:customPrompt.enable,onChange:function onChange(e){set_customPrompt(_objectSpread(_objectSpread({},customPrompt),{},{enable:e.target.checked}))}})),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Group,{className:(0,_index.cls)("custom-input",customPrompt.enable?"":"hide")},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.InputGroup,{className:"mb-3"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.InputGroup.Prepend,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"primary",onClick:function onClick(_){customPrompt.list.unshift({title:"Untitled",content:""});customPrompt.idx=0;set_customPrompt(_objectSpread({},customPrompt))}},"New Prompt")),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Control,{as:"select",custom:true,value:customPrompt.idx,onChange:function onChange(e){_store.selectPrompt(e.target.value)}},customPrompt.list.map(function(t,idx){return/*#__PURE__*/_react["default"].createElement("option",{value:idx},t.title)})),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.InputGroup.Prepend,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"danger",onClick:(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(_){return _regenerator().w(function(_context){while(1)switch(_context.n){case 0:_context.n=1;return confirmModal("delete this prompt?");case 1:if(!_context.v){_context.n=2;break}customPrompt.list.splice(customPrompt.idx,1);customPrompt.idx=customPrompt.list.length-1;set_customPrompt(_objectSpread({},customPrompt));case 2:return _context.a(2)}},_callee)}));return function(_x){return _ref2.apply(this,arguments)}}()),disabled:customPrompt.list.length<2},"Delete"))),/*#__PURE__*/_react["default"].createElement(Summary,{placeHolder:"<Title>\nPrompt content..",title:"Custom prompt",value:function(t){return t?t.raw:""}(customPrompt.list[customPrompt.idx]),onChange:function onChange(value){var _value$match=value.match(/^\s*<(.*?)>\s*([\S\s]*)|$/),_value$match2=_slicedToArray(_value$match,3),title=_value$match2[1],content=_value$match2[2];var r=customPrompt.list[customPrompt.idx];r.title=title||"Untitled";r.content=content||(title?"":value);r.raw=value;set_customPrompt(_objectSpread({},customPrompt))}})));_react["default"].useEffect(function(_){if(_store.getApikey(true)===model.byApikey)return;_store.loadModels()},[apiKey]);return/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form,{className:"main-content-bs setting-form"},ApiKey,Model,SystemPrompt,CustomPrompt,ContextLength,Temperature,/*#__PURE__*/_react["default"].createElement("div",{className:"btns"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{className:"btn-sm",variant:"primary",onClick:function onClick(_){_store.exportSetting()}},"Export setting"),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{className:"btn-sm",variant:"info",onClick:function onClick(_){_store.importSetting()}},"Import setting"),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.OverlayTrigger,{overlay:/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Tooltip,{id:"tooltip-setting-btn"},"Load setting from github.")},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{className:"btn-sm",variant:"danger",onClick:(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(_){return _regenerator().w(function(_context2){while(1)switch(_context2.n){case 0:_context2.n=1;return confirmModal("Override settings?");case 1:if(!_context2.v){_context2.n=2;break}_store.importDefaultSetting();case 2:return _context2.a(2)}},_callee2)}));return function(_x2){return _ref3.apply(this,arguments)}}())},"Import default setting"))))}function EmptyMessage(props){return/*#__PURE__*/_react["default"].createElement("h2",{className:"empty-panel"},/*#__PURE__*/_react["default"].createElement("i",{className:"bi bi-emoji-expressionless-fill"}),"No message.")}function ChatPanel(props){var wideScreen=_store2.store.wideScreen;return/*#__PURE__*/_react["default"].createElement("div",{className:(0,_index.cls)("chat-panel",wideScreen.useValue()&&"wide-screen")},/*#__PURE__*/_react["default"].createElement(MsgBox,null),/*#__PURE__*/_react["default"].createElement(InputArea,null))}function HistoryPanel(props){var history=_store2.store.messageHistory.useValue();return/*#__PURE__*/_react["default"].createElement("div",{className:"history-panel"},history.length?/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Alert,{className:"clear-history",variant:"danger"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"danger",className:"btn-sm",onClick:(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee3(_){return _regenerator().w(function(_context3){while(1)switch(_context3.n){case 0:_context3.n=1;return confirmModal("Delete all histories?");case 1:if(!_context3.v){_context3.n=2;break}_store.deleteHistories();case 2:return _context3.a(2)}},_callee3)}));return function(_x3){return _ref4.apply(this,arguments)}}())},"Delete all histories.")),history.map(function(h){return/*#__PURE__*/_react["default"].createElement("div",{className:"msgbox",key:h.messages[0].key},h.messages.map(function(msg,i){return/*#__PURE__*/_react["default"].createElement(Msg,{msg:msg,onDelete:(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee4(_){return _regenerator().w(function(_context4){while(1)switch(_context4.n){case 0:_context4.n=1;return confirmModal("Delete this message?");case 1:if(!_context4.v){_context4.n=2;break}_store.deleteHistory(i,h);case 2:return _context4.a(2)}},_callee4)}));return function(_x4){return _ref5.apply(this,arguments)}}())})}))})):/*#__PURE__*/_react["default"].createElement(EmptyMessage,null))}function MsgBox(props){var _list2,_list3;var systemPrompt=_store.getPresetPrompt(false);var messages=_store2.store.messages.useValue();var list=messages.list,isResponsing=messages.isResponsing;var boxRef=_react["default"].useRef(null);function scroll(){boxRef.current.scrollTo(0,9e9)}_react["default"].useEffect(function(_){var _list;if((_list=list[list.length-1])!==null&&_list!==void 0&&_list.isPending){scroll()}},[isResponsing,(_list2=list[list.length-1])===null||_list2===void 0?void 0:_list2.text,(_list3=list[list.length-1])===null||_list3===void 0?void 0:_list3.thinking]);_react["default"].useEffect(function(_){scroll()},[]);var lastScrollp=_react["default"].useRef(0);var _store$customPrompt$u3=_store2.store.customPrompt.use(),_store$customPrompt$u4=_slicedToArray(_store$customPrompt$u3,2),customPrompt=_store$customPrompt$u4[0],set_customPrompt=_store$customPrompt$u4[1];return/*#__PURE__*/_react["default"].createElement("div",{className:"chat-messages"},systemPrompt&&/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Accordion,{className:"preset-card"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Card,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Card.Header,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.ButtonGroup,{"aria-label":"Basic example"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Accordion.Toggle,{className:"preset-prompt-btn btn-sm",as:_reactBootstrap.Button,eventKey:"preset-prompt"},/*#__PURE__*/_react["default"].createElement("i",{className:"bi bi-info-circle-fill"}),"Prompt"),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Control,{as:"select",size:"sm",custom:true,className:"btn",value:customPrompt.enable?customPrompt.idx:-1,onChange:function onChange(e){_store.selectPrompt(e.target.value)}},/*#__PURE__*/_react["default"].createElement("option",{value:-1},"- Disabled -"),customPrompt.list.map(function(t,idx){return/*#__PURE__*/_react["default"].createElement("option",{value:idx},t.title)})))),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Accordion.Collapse,{eventKey:"preset-prompt"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Alert,{variant:"info",className:"preset-prompt"},/*#__PURE__*/_react["default"].createElement("pre",null,systemPrompt))))),/*#__PURE__*/_react["default"].createElement("div",{className:"msgbox",ref:function ref(target){boxRef.current=target}},list.length?/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,list.map(function(msg,i){return/*#__PURE__*/_react["default"].createElement(Msg,{msg:msg,onReload:(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee5(_){return _regenerator().w(function(_context5){while(1)switch(_context5.n){case 0:_context5.n=1;return confirmModal("Reload answer?");case 1:if(!_context5.v){_context5.n=2;break}_store.reloadAnswer(i);case 2:return _context5.a(2)}},_callee5)}));return function(_x5){return _ref6.apply(this,arguments)}}()),onDelete:(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee6(_){return _regenerator().w(function(_context6){while(1)switch(_context6.n){case 0:_context6.n=1;return confirmModal("Delete this message?");case 1:if(!_context6.v){_context6.n=2;break}_store.deleteMessage(i);case 2:return _context6.a(2)}},_callee6)}));return function(_x6){return _ref7.apply(this,arguments)}}())})}),/*#__PURE__*/_react["default"].createElement("center",{className:"function-btns"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.OverlayTrigger,{overlay:/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Tooltip,{id:"tooltip-newchat"},"Start a new chat")},/*#__PURE__*/_react["default"].createElement("span",{className:"d-inline-block"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"warning",disabled:isResponsing||!list.length,className:"btn-sm",onClick:function onClick(_){_store.newChat()}},/*#__PURE__*/_react["default"].createElement("i",{className:"new-ico bi bi-arrow-return-left"}),"New chat"))))):/*#__PURE__*/_react["default"].createElement(EmptyMessage,null)))}function Msg(props){var onReload=props.onReload,onDelete=props.onDelete,msg=props.msg;var key=msg.key,isQuestion=msg.isQuestion,text=msg.text,thinking=msg.thinking,html=msg.html,time=msg.time,user=msg.user,model=msg.model,isActive=msg.isActive,isPending=msg.isPending,isError=msg.isError;var _React$useState3=_react["default"].useState(false),_React$useState4=_slicedToArray(_React$useState3,2),plain=_React$useState4[0],set_plain=_React$useState4[1];return/*#__PURE__*/_react["default"].createElement("div",{key:key,"class":(0,_index.cls)("text",isQuestion?"question":"answer",isActive&&"active")},/*#__PURE__*/_react["default"].createElement("div",{className:"info"},/*#__PURE__*/_react["default"].createElement("div",{className:"user"},/*#__PURE__*/_react["default"].createElement("i",{className:(0,_index.cls)("icon","bi",isQuestion?"bi-person-circle":"bi-emoji-smile")}),/*#__PURE__*/_react["default"].createElement("div",{className:"li"},/*#__PURE__*/_react["default"].createElement("div",{className:"name"},user||model),/*#__PURE__*/_react["default"].createElement("div",{className:"time"},time))),/*#__PURE__*/_react["default"].createElement("div",{className:"tool-btns"},isQuestion?null:/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Form.Check,{type:"switch",id:"answer-source-"+key,label:"Show source",className:"btn-sm",checked:plain,onChange:function onChange(e){set_plain(e.target.checked)}}),isPending?null:/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,isQuestion?null:onReload&&/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"info",className:"btn-sm",onClick:onReload},/*#__PURE__*/_react["default"].createElement("i",{className:"bi bi-arrow-clockwise"})),onDelete&&/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"danger",className:"btn-sm",onClick:onDelete},/*#__PURE__*/_react["default"].createElement("i",{className:"bi bi-x-lg"}))))),/*#__PURE__*/_react["default"].createElement("div",{className:"message"},text||thinking?isQuestion?/*#__PURE__*/_react["default"].createElement("pre",{className:"user-input"},text):plain||!html?/*#__PURE__*/_react["default"].createElement("div",{className:"md-text plain"},thinking&&"<think>\n".concat(thinking,"\n</think>"),text):/*#__PURE__*/_react["default"].createElement("div",{className:"md-text",dangerouslySetInnerHTML:{__html:html}}):/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Spinner,{style:{margin:10},size:"sm",animation:"border"})))}function InputArea(props){var _store$inputValue$use=_store2.store.inputValue.use(),_store$inputValue$use2=_slicedToArray(_store$inputValue$use,2),inputValue=_store$inputValue$use2[0],set_inputValue=_store$inputValue$use2[1];var _React$useState5=_react["default"].useState(false),_React$useState6=_slicedToArray(_React$useState5,2),active=_React$useState6[0],set_active=_React$useState6[1];var messages=_store2.store.messages.useValue();var wideScreen=_store2.store.wideScreen.useValue();var inputRef=_react["default"].useRef(null);var model=_store2.store.model.useValue();var _store$sendWithHistor=_store2.store.sendWithHistory.use(),_store$sendWithHistor2=_slicedToArray(_store$sendWithHistor,2),sendWithHistory=_store$sendWithHistor2[0],set_sendWithHistory=_store$sendWithHistor2[1];var _store$enterSend$use=_store2.store.enterSend.use(),_store$enterSend$use2=_slicedToArray(_store$enterSend$use,2),enterSend=_store$enterSend$use2[0],set_enterSend=_store$enterSend$use2[1];var _store$multiLineInput=_store2.store.multiLineInput.use(),_store$multiLineInput2=_slicedToArray(_store$multiLineInput,2),multiLineInput=_store$multiLineInput2[0],set_multiLineInput=_store$multiLineInput2[1];var showAsMultiLine=wideScreen||multiLineInput;_react["default"].useEffect(function(_){if(messages.isResponsing)return;api.saveMessages();if(!showAsMultiLine)inputRef.current.focus()},[messages.isResponsing]);function send(){var v=inputValue.trim();if(!v)return false;set_inputValue("");_store.ask(v);return true}return/*#__PURE__*/_react["default"].createElement(_reactBootstrap.InputGroup,{className:"input-area"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.FormControl,{ref:function ref(target){inputRef.current=target},readOnly:model.isError,placeholder:"Ask me anything..",as:showAsMultiLine?"textarea":"input",className:active||inputValue?"active":"",value:inputValue,onMouseMove:function onMouseMove(e){if(wideScreen)inputRef.current.focus()},onChange:function onChange(e){set_inputValue(e.target.value)},onFocus:function onFocus(_){set_active(true)},onBlur:function onBlur(_){set_active(false)},onKeyPress:function onKeyPress(e){if(!enterSend)return;if((e.charCode==13||e.code==="Enter")&&!e.shiftKey){var _inputRef$current;if(!send())return;set_active(false);(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0||_inputRef$current.blur()}},onMouseOver:function onMouseOver(_){if(!multiLineInput)inputRef.current.focus()}}),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.ButtonGroup,null,/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"success",onClick:send},"Send"),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.OverlayTrigger,{placement:"top",overlay:/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Tooltip,null,sendWithHistory?"Send message with history.":"Send message without history.")},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:sendWithHistory?"danger":"secondary",onClick:function onClick(_){set_sendWithHistory(!sendWithHistory)}},/*#__PURE__*/_react["default"].createElement("i",{className:(0,_index.cls)("bi",sendWithHistory?"bi-clock-fill":"bi-clock-history")}))),/*#__PURE__*/_react["default"].createElement(_reactBootstrap.OverlayTrigger,{placement:"top",overlay:/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Tooltip,null,enterSend?"Send message when enter pressed.":"Send message after click send button")},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:enterSend?"primary":"secondary",className:"enter-switch",onClick:function onClick(_){set_enterSend(!enterSend)}},/*#__PURE__*/_react["default"].createElement("i",{className:(0,_index.cls)("bi",enterSend?"bi-sign-turn-right":"bi-sign-no-right-turn-fill")}))),wideScreen?null:/*#__PURE__*/_react["default"].createElement(_reactBootstrap.OverlayTrigger,{placement:"top",overlay:/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Tooltip,null,multiLineInput?"Multiline inputbox.":"Singleline inputbox.")},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:multiLineInput?"info":"secondary",onClick:function onClick(_){set_multiLineInput(!multiLineInput)}},/*#__PURE__*/_react["default"].createElement("i",{className:(0,_index.cls)("bi",multiLineInput?"bi-list":"bi-dash")})))),function(_){if(model.isError){return/*#__PURE__*/_react["default"].createElement("div",{className:"stop-btn",onClick:function onClick(_){if(!(0,_index.isLocalServer)()){_store2.store.activeTabIdx.setValue(1)}}},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"warning",onClick:function onClick(_){_store.loadModels()}},/*#__PURE__*/_react["default"].createElement("i",{"class":"icon bi bi-emoji-dizzy-fill"}),"No available model.",(0,_index.isLocalServer)()?null:/*#__PURE__*/_react["default"].createElement("div",null,"Go to [Setting], and apply an api key.")))}if(messages.isResponsing){return/*#__PURE__*/_react["default"].createElement("div",{className:"stop-btn"},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Button,{variant:"primary",onClick:function onClick(_){api.resetOllamaClient()}},/*#__PURE__*/_react["default"].createElement(_reactBootstrap.Spinner,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true",className:"icon"}),"Click to stop responsing..."))}}()||null)}_reactDom["default"].render(/*#__PURE__*/_react["default"].createElement(App,null),document.getElementById("app"))},"/src/api.js":function _src_apiJs(require,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.chat=chat;exports.getModels=getModels;exports.loadConfig=loadConfig;exports.loadMessages=loadMessages;exports.resetOllamaClient=resetOllamaClient;exports.saveConfig=saveConfig;exports.saveMessages=saveMessages;var _index=require("/src/utils/index.js");var _store2=_interopRequireWildcard(require("/src/store.js"));var _store=_store2;function _interopRequireWildcard(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(_interopRequireWildcard=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;var o,i,f={__proto__:null,"default":e};if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return f;if(o=t?n:r){if(o.has(e))return o.get(e);o.set(e,f)}for(var _t in e)"default"!==_t&&{}.hasOwnProperty.call(e,_t)&&((i=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,_t))&&(i.get||i.set)?o(f,_t,i):f[_t]=e[_t]);return f})(e,t)}function _regenerator(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function getModels(){return _getModels.apply(this,arguments)}function _getModels(){_getModels=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(){return _regenerator().w(function(_context){while(1)switch(_context.n){case 0:return _context.a(2,(0,_index.callApi)("listModels"))}},_callee)}));return _getModels.apply(this,arguments)}function resetOllamaClient(){return _resetOllamaClient.apply(this,arguments)}function _resetOllamaClient(){_resetOllamaClient=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(){return _regenerator().w(function(_context2){while(1)switch(_context2.n){case 0:return _context2.a(2,(0,_index.callApi)("resetChat"))}},_callee2)}));return _resetOllamaClient.apply(this,arguments)}function chat(_x,_x2){return _chat.apply(this,arguments)}function _chat(){_chat=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee3(msgs,onData){var modelName,temperature,num_ctx;return _regenerator().w(function(_context3){while(1)switch(_context3.n){case 0:modelName=_store.getModelName();temperature=parseFloat(_store2.store.temperature.getValue());num_ctx=parseInt(_store2.store.contextLength.getValue());return _context3.a(2,(0,_index.callApi)("chat",{postData:JSON.stringify({model:modelName,messages:msgs.map(function(_ref){var isQuestion=_ref.isQuestion,text=_ref.text,thinking=_ref.thinking;return{role:isQuestion?"user":"system",content:isQuestion&&text.indexOf("```")===-1?"```plain\n"+text+"\n```":text,thinking:thinking}}),options:{temperature:temperature,num_ctx:num_ctx}}),onData:onData}))}},_callee3)}));return _chat.apply(this,arguments)}function loadConfig(){try{var _JSON$parse=JSON.parse(localStorage.getItem("ollama-webui-state-config")),_JSON$parse2=_slicedToArray(_JSON$parse,9),apiKey=_JSON$parse2[0],prompt=_JSON$parse2[1],contextLength=_JSON$parse2[2],temperature=_JSON$parse2[3],model=_JSON$parse2[4],customPrompt=_JSON$parse2[5],sendWithHistory=_JSON$parse2[6],enterSend=_JSON$parse2[7],multiLineInput=_JSON$parse2[8];if(!(0,_index.isLocalServer)())apiKey.enable=true;_store2.store.apiKey.setValue(apiKey);_store2.store.prompt.setValue(prompt);_store2.store.contextLength.setValue(contextLength);_store2.store.temperature.setValue(temperature);_store2.store.model.setValue(model);_store2.store.customPrompt.setValue(customPrompt);_store2.store.sendWithHistory.setValue(sendWithHistory);_store2.store.enterSend.setValue(enterSend);_store2.store.multiLineInput.setValue(multiLineInput)}catch(e){}}function saveConfig(){var settings=JSON.stringify([_store2.store.apiKey.getValue(),_store2.store.prompt.getValue(),_store2.store.contextLength.getValue(),_store2.store.temperature.getValue(),_store2.store.model.getValue(),_store2.store.customPrompt.getValue(),_store2.store.sendWithHistory.getValue(),_store2.store.enterSend.getValue(),_store2.store.multiLineInput.getValue()]);localStorage.setItem("ollama-webui-state-config",settings)}function loadMessages(){try{var _JSON$parse3=JSON.parse(localStorage.getItem("ollama-webui-state-messages")),_JSON$parse4=_slicedToArray(_JSON$parse3,2),messages=_JSON$parse4[0],history=_JSON$parse4[1];_store2.store.messages.setValue(messages);_store2.store.messageHistory.setValue(history)}catch(e){}}function saveMessages(){try{var messages=_store2.store.messages.getValue();var messageHistory=_store2.store.messageHistory.getValue();localStorage.setItem("ollama-webui-state-messages",JSON.stringify([messages,messageHistory]))}catch(e){}}},"/src/store.js":function _src_storeJs(require,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.ask=ask;exports.deleteHistories=deleteHistories;exports.deleteHistory=deleteHistory;exports.deleteMessage=deleteMessage;exports.exportSetting=exportSetting;exports.getApikey=getApikey;exports.getModelName=getModelName;exports.getPresetPrompt=getPresetPrompt;exports.importDefaultSetting=importDefaultSetting;exports.importSetting=importSetting;exports.initStore=initStore;exports.loadModels=loadModels;exports.newChat=newChat;exports.reloadAnswer=reloadAnswer;exports.selectModel=selectModel;exports.selectPrompt=selectPrompt;exports.store=void 0;exports.useAutoSave=useAutoSave;exports.useHistoryCount=useHistoryCount;exports.useWideScreenChange=useWideScreenChange;var _react=_interopRequireDefault(require("react"));var _reactCrossComponentState=_interopRequireDefault(require("react-cross-component-state"));var _index=require("/src/utils/index.js");var _patch=_interopRequireDefault(require("/src/utils/patch.js"));var api=_interopRequireWildcard(require("/src/api.js"));var _document$querySelect;function _interopRequireWildcard(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(_interopRequireWildcard=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;var o,i,f={__proto__:null,"default":e};if(null===e||"object"!=_typeof(e)&&"function"!=typeof e)return f;if(o=t?n:r){if(o.has(e))return o.get(e);o.set(e,f)}for(var _t3 in e)"default"!==_t3&&{}.hasOwnProperty.call(e,_t3)&&((i=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,_t3))&&(i.get||i.set)?o(f,_t3,i):f[_t3]=e[_t3]);return f})(e,t)}function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+""}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _regenerator(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}var store=exports.store={activeTabIdx:(0,_reactCrossComponentState["default"])(0),apiKey:(0,_reactCrossComponentState["default"])(function(_){return{enable:(0,_index.isLocalServer)()?false:true,value:""}}),prompt:(0,_reactCrossComponentState["default"])(function(_){return{enable:false,value:""}}),customPrompt:(0,_reactCrossComponentState["default"])(function(_){return{enable:false,list:[{title:"Untitled",content:""}],idx:0}}),model:(0,_reactCrossComponentState["default"])(function(_){return{names:[],idx:null,selects:{},byApikey:"",isLoading:true,isError:false}}),temperature:(0,_reactCrossComponentState["default"])(0),contextLength:(0,_reactCrossComponentState["default"])(8*1024),messages:(0,_reactCrossComponentState["default"])(function(_){return{list:[],isResponsing:false}}),messageHistory:(0,_reactCrossComponentState["default"])(function(_){return[]}),sendWithHistory:(0,_reactCrossComponentState["default"])(false),enterSend:(0,_reactCrossComponentState["default"])(true),multiLineInput:(0,_reactCrossComponentState["default"])(false),inputValue:(0,_reactCrossComponentState["default"])(""),dialogData:(0,_reactCrossComponentState["default"])({show:false,title:null,content:null}),wideScreen:(0,_reactCrossComponentState["default"])((0,_index.isWideScreen)()),about:(_document$querySelect=document.querySelector("[type=\"text/x-template\"][id=\"site-about\"]"))===null||_document$querySelect===void 0?void 0:_document$querySelect.innerHTML};function initStore(){return _initStore.apply(this,arguments)}function _initStore(){_initStore=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(){return _regenerator().w(function(_context2){while(1)switch(_context2.n){case 0:api.resetOllamaClient();api.loadConfig();api.loadMessages();loadModels();case 1:return _context2.a(2)}},_callee2)}));return _initStore.apply(this,arguments)}function getModelName(){var model=store.model.getValue();return model.names[model.idx]}function exportSetting(){var ret={prompt:store.prompt.getValue(),customPrompt:store.customPrompt.getValue()};var _url=URL.createObjectURL(new Blob([encodeURIComponent(JSON.stringify(ret))],{type:"text/plain"}));var a=document.body.appendChild(document.createElement("a"));a.href=_url;a.download="setting.txt";a.click();document.body.removeChild(a);URL.revokeObjectURL(_url)}function loadSetting(text){try{var s=JSON.parse(decodeURIComponent(text));for(var k in s){var _store$k;(_store$k=store[k])===null||_store$k===void 0||_store$k.setValue(s[k])}alertModal("Import config successful!")}catch(e){console.log(e);alertModal(/*#__PURE__*/_react["default"].createElement(_react["default"].Fragment,null,/*#__PURE__*/_react["default"].createElement("div",null,"Failed to load config:"),/*#__PURE__*/_react["default"].createElement("pre",null,e.stack)))}}function alertModal(msg){return new Promise(function(resolve){store.dialogData.setValue({show:true,title:"ollama-ui",content:/*#__PURE__*/_react["default"].createElement("div",{className:"alert-model-content"},msg),onConfirm:resolve,// large: true,
cancelButton:false})})}function importDefaultSetting(){return _importDefaultSetting.apply(this,arguments)}function _importDefaultSetting(){_importDefaultSetting=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee3(){var f,_t2;return _regenerator().w(function(_context3){while(1)switch(_context3.n){case 0:_context3.n=1;return fetch("https://raw.githubusercontent.com/kagami-arch-jp/ollama-ui/refs/heads/main/dist/setting.txt");case 1:f=_context3.v;_t2=loadSetting;_context3.n=2;return f.text();case 2:_t2(_context3.v);case 3:return _context3.a(2)}},_callee3)}));return _importDefaultSetting.apply(this,arguments)}function importSetting(){var inp=document.createElement("input");inp.type="file";inp.accept=".txt";inp.className="hidden-btn";inp.addEventListener("change",/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(event){var file,_t;return _regenerator().w(function(_context){while(1)switch(_context.n){case 0:file=event.target.files[0];if(!file){_context.n=2;break}_t=loadSetting;_context.n=1;return file.text();case 1:_t(_context.v);case 2:inp.remove();case 3:return _context.a(2)}},_callee)}));return function(_x){return _ref.apply(this,arguments)}}());inp.click();document.body.appendChild(inp)}function getApikey(returnFragment){var apiKey=store.apiKey.getValue();var e=apiKey.enable&&apiKey.value;if(!e)return"";if(returnFragment)return e.substr(10,8);return e}function newMsg(content){var isQuestion=content?true:false;return{key:(0,_index.newUUID)(),isQuestion:isQuestion||false,text:isQuestion?content:"",user:isQuestion?"anonymous":"",thinking:"",html:"",model:isQuestion?"":getModelName(),time:(0,_index.formatTime)(),isPending:isQuestion?false:true,isError:false,isActive:false}}function ask(question){var answerIdx=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;var messages=store.messages.getValue();messages.isResponsing=true;var isNewQuestion=answerIdx===-1;var ans=isNewQuestion?newMsg():messages.list[answerIdx];if(isNewQuestion){var msg=newMsg(question);messages.list.push(msg,ans);setTimeout(function(_){msg.isActive=true;store.messages.setValue(_objectSpread({},messages))},100)}setTimeout(function(_){ans.isActive=true;store.messages.setValue(_objectSpread({},messages))},200);var patch=(0,_patch["default"])(getModelName());var update=(0,_index.throttle)(function(err,isEnd){ans.html=[ans.thinking&&"<div class=\"think\">".concat((0,_index.markdown)(ans.thinking),"</div>"),ans.text&&(0,_index.markdown)(ans.text)].filter(Boolean).join("");if(err||isEnd){api.resetOllamaClient();ans.isPending=false;messages.isResponsing=false}store.messages.setValue(_objectSpread({},messages))},200);var sendWithHistory=store.sendWithHistory.getValue();var prompt=getPresetPrompt(true);var msgs=[{isQuestion:true,text:prompt}];var history=messages.list.slice(0,isNewQuestion?messages.list.length-1:answerIdx);var ques=history.pop();if(sendWithHistory){msgs.push.apply(msgs,_toConsumableArray(history).concat([ques]))}else{msgs.push(ques)}api.chat(msgs,function(e,isEnd,ret){if(patch.isEnd)return;var _JSON$parse=JSON.parse(ret||"{}"),content=_JSON$parse.content,thinking=_JSON$parse.thinking;if(content)ans.text+=content;else if(thinking)ans.thinking+=thinking;var err=e||(isEnd&&!ans.text?new Error("Unknown error"):null);if(err){ans.text+="\n### "+err.message;ans.isError=true}else if(content){var _patch$text=patch.text(ans.text),_patch$text2=_slicedToArray(_patch$text,2),realEnd=_patch$text2[0],text=_patch$text2[1];if(realEnd){isEnd=true;ans.text=text}}update(err,isEnd)})}function loadModels(){return _loadModels.apply(this,arguments)}function _loadModels(){_loadModels=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee4(){var model,mod,arr,name,idx;return _regenerator().w(function(_context4){while(1)switch(_context4.n){case 0:model=_objectSpread(_objectSpread({},store.model.getValue()),{},{isLoading:true,isError:false,byApikey:getApikey(true)});store.model.setValue(model);_context4.n=1;return api.getModels();case 1:mod=_context4.v;arr=mod===null||mod===void 0?void 0:mod.result;if(Array.isArray(arr)){_context4.n=2;break}store.model.setValue(_objectSpread(_objectSpread({},model),{},{isLoading:false,isError:true,names:[],idx:-1}));return _context4.a(2);case 2:model.selects=model.selects||{};name=model.selects[model.byApikey]||model.names[model.idx];idx=arr.findIndex(function(x){return x===name});model.selects[model.byApikey]=name;store.model.setValue(_objectSpread(_objectSpread({},model),{},{names:arr,idx:idx<0?0:idx,isLoading:false,isError:false}));case 3:return _context4.a(2)}},_callee4)}));return _loadModels.apply(this,arguments)}function selectModel(idx){var model=store.model.getValue();model.idx=idx;model.selects[model.byApikey]=model.names[idx];store.model.setValue(_objectSpread({},model))}function getPresetPrompt(returnRealtime){var now=new Date().toLocaleString();var day="\u65E5\u6708\u706B\u6C34\u6728\u91D1\u571F".charAt(new Date().getDay())+"\u66DC\u65E5";var systemPrompt=store.prompt.getValue();var customPrompt=store.customPrompt.getValue();return[returnRealtime&&"\u4ECA\u306F\u300C".concat(now,"\u300D\u3067\u3059\u3002\u4ECA\u65E5\u306F\u300C").concat(day,"\u300D\u3067\u3059\u3002"),systemPrompt.enable&&systemPrompt.value,customPrompt.enable&&customPrompt.list[customPrompt.idx].content].filter(Boolean).join("\n")}function newChat(){var messages=store.messages.getValue();var messageHistory=store.messageHistory.getValue();store.messageHistory.setValue([].concat(_toConsumableArray(messageHistory),[{messages:messages.list,sendWithHistory:store.sendWithHistory.getValue(),enterSend:store.enterSend.getValue(),multiLineInput:store.multiLineInput.getValue()}]));store.messages.setValue(_objectSpread(_objectSpread({},messages),{},{list:[],isResponsing:false}));api.saveMessages()}function deleteMessage(i){var messages=store.messages.getValue();messages.list.splice(i,1);store.messages.setValue(_objectSpread({},messages));api.saveMessages()}function useHistoryCount(){var messageHistory=store.messageHistory.useValue();return messageHistory.reduce(function(n,h){return n+h.messages.length},0)}function deleteHistory(i,history){var messageHistory=store.messageHistory.getValue();history.messages.splice(i,1);messageHistory=messageHistory.filter(function(x){return x.messages.length});store.messageHistory.setValue(_toConsumableArray(messageHistory));api.saveMessages()}function useAutoSave(){var throttleSave=_react["default"].useCallback((0,_index.throttle)(api.saveConfig,1e3),[]);_react["default"].useEffect(throttleSave,[store.apiKey.useValue(),store.prompt.useValue(),store.contextLength.useValue(),store.temperature.useValue(),store.model.useValue(),store.customPrompt.useValue(),store.sendWithHistory.useValue(),store.enterSend.useValue(),store.multiLineInput.useValue()])}function deleteHistories(){store.messageHistory.setValue([]);api.saveMessages()}function reloadAnswer(i){var messages=store.messages.getValue();messages.list[i]=newMsg();ask(messages.list[i-1].text,i);store.messages.setValue(_objectSpread({},messages))}function useWideScreenChange(){_react["default"].useEffect(function(_){var _width=innerWidth,_height=innerHeight;var fn=function fn(_){if(innerHeight<_height&&innerWidth===_width)return;_width=innerWidth;_height=innerHeight;store.wideScreen.setValue((0,_index.isWideScreen)())};window.addEventListener("resize",fn);return function(_){return window.removeEventListener("resize",fn)}},[])}function selectPrompt(idx){var customPrompt=store.customPrompt;var val=customPrompt.getValue();if(idx<0){val.enable=false}else{val.idx=0;val.list.unshift(val.list.splice(idx,1)[0]);val.enable=true}customPrompt.setValue(_objectSpread({},val))}},"/src/utils/index.js":function _src_utils_indexJs(require,exports){"use strict";function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}Object.defineProperty(exports,"__esModule",{value:true});exports.callApi=callApi;exports.cls=cls;exports.formatTime=formatTime;exports.isLocalServer=isLocalServer;exports.isWideScreen=isWideScreen;exports.loadCss=loadCss;exports.loadScript=loadScript;exports.markdown=markdown;exports.newUUID=newUUID;exports.throttle=throttle;var _store=require("/src/store.js");function _regeneratorValues(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function next(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(_typeof(e)+" is not iterable")}function _regenerator(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=n&&n.prototype instanceof Generator?n:Generator,u=Object.create(c.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var i,c,u,f=0,p=o||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function d(t,r){return i=t,c=0,u=e,G.n=r,a}};function d(r,n){for(c=r,u=n,t=0;!y&&f&&!o&&t<p.length;t++){var o,i=p[t],d=G.p,l=i[2];r>3?(o=l===n)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=r<2&&d<i[1])?(c=0,G.v=n,G.n=i[1]):d<l&&(o=r<3||i[0]>n||n>l)&&(i[4]=r,i[5]=n,G.n=l,c=0))}if(o||r>1)return a;throw y=!0,n}return function(o,p,l){if(f>1)throw TypeError("Generator is already running");for(y&&1===p&&d(p,l),c=p,u=l;(t=c<2?e:u)||!y;){i||(c?c<3?(c>1&&(G.n=-1),d(c,u)):G.n=u:G.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i["return"])&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(y=G.n<0)?u:r.call(n,G))!==a)break}catch(t){i=e,c=1,u=t}finally{f=1}}return{value:t,done:y}}}(r,o,i),!0),u}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine2(u),_regeneratorDefine2(u,o,"Generator"),_regeneratorDefine2(u,n,function(){return this}),_regeneratorDefine2(u,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(e,r,n,t){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}_regeneratorDefine2=function _regeneratorDefine(e,r,n,t){function o(r,n){_regeneratorDefine2(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(e,r,n,t)}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return void e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}}function cls(){for(var _len=arguments.length,c=new Array(_len),_key=0;_key<_len;_key++){c[_key]=arguments[_key]}return c.filter(Boolean).join(" ")}var sessid=0;var key_prefix=(Date.now()+Math.random()).toString(36).replace(/\./g,"-")+"-";function newUUID(){return key_prefix+"-"+(sessid++).toString(36)}function formatTime(){var a=new Date;return a.toLocaleString()}function isWideScreen(){return innerWidth>innerHeight*1.1}function isLocalServer(){return location.href.indexOf("127.0.0.1")>-1}function callApi(_x,_x2){return _callApi.apply(this,arguments)}function _callApi(){_callApi=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(action,opt){var _ref,postData,onData,_store$apiKey$getValu,enable,value,option,req,response,reader,dec,_loop,_t2;return _regenerator().w(function(_context2){while(1)switch(_context2.p=_context2.n){case 0:_ref=opt||{},postData=_ref.postData,onData=_ref.onData;_store$apiKey$getValu=_store.store.apiKey.getValue(),enable=_store$apiKey$getValu.enable,value=_store$apiKey$getValu.value;option={headers:{"x-ollama-apikey":enable&&value||""}};if(postData){Object.assign(option,{method:"POST",body:postData})}req=fetch("/"+action,option);if(!onData){_context2.n=9;break}_context2.p=1;_context2.n=2;return req;case 2:response=_context2.v;reader=response.body.getReader();dec=new TextDecoder;_loop=/*#__PURE__*/_regenerator().m(function _loop(){var _yield$reader$read,done,value;return _regenerator().w(function(_context){while(1)switch(_context.n){case 0:_context.n=1;return reader.read();case 1:_yield$reader$read=_context.v;done=_yield$reader$read.done;value=_yield$reader$read.value;if(value){dec.decode(value).split("\n").map(function(val){try{if(JSON.parse(val))onData(null,done,val)}catch(e){}})}else{onData(null,done,null)}if(!done){_context.n=2;break}return _context.a(2,1);case 2:return _context.a(2)}},_loop)});case 3:return _context2.d(_regeneratorValues(_loop()),4);case 4:if(!_context2.v){_context2.n=5;break}return _context2.a(3,6);case 5:_context2.n=3;break;case 6:_context2.n=8;break;case 7:_context2.p=7;_t2=_context2.v;onData(_t2);case 8:_context2.n=11;break;case 9:_context2.n=10;return req;case 10:return _context2.a(2,_context2.v.json());case 11:return _context2.a(2)}},_callee,null,[[1,7]])}));return _callApi.apply(this,arguments)}function markdown(str){var _marked=new marked.Marked;_marked.use({renderer:{html:function html(x){return x.raw.replace(/<br\s*\/?>/g,"\n").replace(/<\/?|</g,function(_){if(_==="<")return"&lt;"}).replace(/\n/g,"<br />")},code:function code(e){return"<pre><code class=\"hljs language-".concat(e.lang||"markdown","\">").concat(hljs.highlight(e.text.trim(),{language:e.lang||"plaintext"}).value,"</code></pre>")}}});// fix marked parse bug
str=str.replace(/(\*\*.+?\*\*)([\S])/g,"$1 $2");return _marked.parse(str,{mangle:false,headerIds:false,silent:true})}function loadScript(_x3,_x4,_x5){return _loadScript.apply(this,arguments)}function _loadScript(){_loadScript=_asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2(src,isModule,jscode){return _regenerator().w(function(_context3){while(1)switch(_context3.n){case 0:return _context3.a(2,new Promise(function(resolve,reject){var s=document.createElement("script");if(src)s.src=resolvePath(src);else if(jscode)s.innerHTML=jscode;s.type=isModule?"module":"text/javascript";s.onload=function(_){return resolve()};s.onerror=function(_){return reject()};document.body.appendChild(s)}))}},_callee2)}));return _loadScript.apply(this,arguments)}function loadCss(src){var e=document.createElement("link");e.rel="stylesheet";e.href=resolvePath(src);e.type="text/css";document.body.appendChild(e)}function throttle(fn,interval){var t=0,e=0;var _fn2=function _fn(){for(var _len2=arguments.length,x=new Array(_len2),_key2=0;_key2<_len2;_key2++){x[_key2]=arguments[_key2]}clearTimeout(e);var _t=Date.now();if(_t-t<interval){e=setTimeout(function(_){return _fn2.apply(void 0,x)},interval);return}fn.apply(void 0,x);t=_t};return _fn2}},"/src/utils/patch.js":function _src_utils_patchJs(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=buildChatPatch;function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function buildChatPatch(model){var patch={isEnd:false,text:function text(x){return[false,x]}};if(model.indexOf("gemma")>-1){patch.text=function(x){var _patchGemmaModelRespo=patchGemmaModelResponse(x),_patchGemmaModelRespo2=_slicedToArray(_patchGemmaModelRespo,2),isEnd=_patchGemmaModelRespo2[0],text=_patchGemmaModelRespo2[1];patch.isEnd=isEnd;return[isEnd,text]}}return patch}function patchGemmaModelResponse(text){var flags=["</end_of_turn>","<end_of_turn>","</start_of_turn>","<start_of_turn>"];for(var _i=0,_flags=flags;_i<_flags.length;_i++){var d=_flags[_i];var i=text.indexOf(d);if(i===-1)continue;return[true,text.substr(0,i)]}return[false,text]}}};function injectCSS(code){var newStyle=document.createElement("style");newStyle.textContent=code;document.head.appendChild(newStyle)}function require(x){if(modules[x]){if(!exports[x]){var exp={};exports[x]={result:exp};modules[x](require,exp)}return exports[x].result}return window[x]||window[map[x]]}injectCSS("body,body #app .empty-panel,html,html #app .empty-panel{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}body,html{margin:0;height:100%;background:#000;font-size:16Px}body .md-text.plain,html .md-text.plain{white-space:break-spaces}body .md-text h1,html .md-text h1{font-size:1.92rem}body .md-text h2,html .md-text h2{font-size:1.68rem}body .md-text h3,html .md-text h3{font-size:1.44rem}body .md-text h4,html .md-text h4{font-size:1.32rem}body .md-text h5,html .md-text h5{font-size:1.2rem}body .md-text h6,html .md-text h6{font-size:1.08rem}body .md-text h1,body .md-text h2,body .md-text h3,html .md-text h1,html .md-text h2,html .md-text h3{font-weight:700}body .md-text h1,body .md-text h2,body .md-text h3,body .md-text h4,body .md-text h5,body .md-text h6,html .md-text h1,html .md-text h2,html .md-text h3,html .md-text h4,html .md-text h5,html .md-text h6{line-height:1.8;margin-bottom:0}body .md-text table,body .md-text td,body .md-text th,html .md-text table,html .md-text td,html .md-text th{border:.06rem solid #ccc;border-collapse:collapse}body .md-text .think,html .md-text .think{font-size:.72rem;line-height:1.5;color:#999;font-style:italic;margin:.3rem}body .md-text .think:before,html .md-text .think:before{content:'Thinking:'}body .md-text table,html .md-text table{background:#ccc;text-align:left;border-spacing:.06rem}body .md-text table th,html .md-text table th{padding:.3rem;background:#eee}body .md-text table td,html .md-text table td{padding:.3rem;background:#fff}body .md-text p,html .md-text p{margin:.12rem 0;white-space:break-spaces}body .md-text ul,html .md-text ul{padding-left:1.2rem}body .md-text pre code,html .md-text pre code{background:#333;color:#fff;display:block;padding:.3rem .6rem;overflow:auto;white-space:pre;word-break:break-word}body .md-text code,html .md-text code{background:#333;color:#ed2;white-space:break-spaces;word-break:break-word;padding:.24rem;border-radius:.24rem}body .md-text .language-hljs-plaintext,body .md-text .language-markdown,html .md-text .language-hljs-plaintext,html .md-text .language-markdown{white-space:break-spaces}body .modal-textarea .modal-dialog,html .modal-textarea .modal-dialog{position:absolute;-webkit-transform:none;transform:none;bottom:0;top:0;left:0;right:0}body .modal-textarea .modal-dialog .modal-body,html .modal-textarea .modal-dialog .modal-body{overflow:hidden}body #app,body .modal-textarea .modal-dialog .modal-body .about-content,html #app,html .modal-textarea .modal-dialog .modal-body .about-content{overflow:auto;height:100%}body .modal-textarea .modal-dialog.modal-lg .modal-content,body .modal-textarea .modal-dialog.modal-lg .modal-content textarea,html .modal-textarea .modal-dialog.modal-lg .modal-content,html .modal-textarea .modal-dialog.modal-lg .modal-content textarea{height:100%}body .alert-model-content pre,html .alert-model-content pre{white-space:pre-line}body #app,html #app{width:100%;background:#fff;margin:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-ms-flexbox;display:flex}body #app .empty-panel,html #app .empty-panel{margin:3rem 0;color:#ddd}body #app .empty-panel .bi,html #app .empty-panel .bi{margin-right:.6rem}body #app .statusbar-box,html #app .statusbar-box{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;width:100%;padding:0 .6rem}body #app .statusbar-box .statusbar,html #app .statusbar-box .statusbar{width:100%;margin:.3rem 0;background:#fff;z-index:99;-webkit-box-shadow:0 0 1.2rem #eee;box-shadow:0 0 1.2rem #eee}body #app .statusbar-box .statusbar .nav-link,html #app .statusbar-box .statusbar .nav-link{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}body #app .statusbar-box .statusbar .nav-link .bi,html #app .statusbar-box .statusbar .nav-link .bi{font-size:.72rem;margin-right:.24rem}body #app .statusbar-box .statusbar .nav-link .history-count,html #app .statusbar-box .statusbar .nav-link .history-count{margin-left:.3rem}body #app .statusbar-box .about-btn,html #app .statusbar-box .about-btn{-ms-flex-item-align:center;align-self:center;font-size:1.08rem;padding:0;width:1.8rem;height:1.8rem;line-height:1.8rem;margin-left:.6rem}body #app .main-content-bs,html #app .main-content-bs{margin:.3rem .6rem}body #app .main-content-bs.setting-form,html #app .main-content-bs.setting-form{margin:0 .9rem;margin-top:.6rem;display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding-left:.3rem;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;overflow-y:scroll;overflow-x:hidden}body #app .main-content-bs.setting-form label,html #app .main-content-bs.setting-form label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}body #app .main-content-bs.setting-form .apikey-config,html #app .main-content-bs.setting-form .apikey-config{display:-webkit-box;display:-ms-flexbox;display:flex;margin-bottom:.6rem}body #app .main-content-bs.setting-form .apikey-config .checker,html #app .main-content-bs.setting-form .apikey-config .checker{margin-right:1.2rem}body #app .main-content-bs.setting-form .apply-key,html #app .main-content-bs.setting-form .apply-key{margin-left:.6rem}body #app .main-content-bs.setting-form .summary,html #app .main-content-bs.setting-form .summary{background:#eee;color:#666;padding:.18rem;height:1.8rem;overflow:hidden;border:.06rem solid #ccc;border-radius:.24rem;text-overflow:ellipsis;white-space:nowrap;cursor:pointer}body #app .main-content-bs.setting-form .loading-model,html #app .main-content-bs.setting-form .loading-model{margin-left:.6rem}body #app .main-content-bs.setting-form .form-group,body #app .main-content-bs.setting-form .input-group,html #app .main-content-bs.setting-form .form-group,html #app .main-content-bs.setting-form .input-group{margin-top:.6rem;margin-bottom:.6rem}body #app .main-content-bs.setting-form .form-group .custom-input,body #app .main-content-bs.setting-form .input-group .custom-input,html #app .main-content-bs.setting-form .form-group .custom-input,html #app .main-content-bs.setting-form .input-group .custom-input{-webkit-transition:.3s;transition:.3s}body #app .main-content-bs.setting-form .form-group .custom-input.hide,body #app .main-content-bs.setting-form .input-group .custom-input.hide,html #app .main-content-bs.setting-form .form-group .custom-input.hide,html #app .main-content-bs.setting-form .input-group .custom-input.hide{height:0;padding:0;margin:-.3rem;overflow:hidden;opacity:0}body #app .main-content-bs.setting-form .form-group .range-input,body #app .main-content-bs.setting-form .input-group .range-input,html #app .main-content-bs.setting-form .form-group .range-input,html #app .main-content-bs.setting-form .input-group .range-input{display:-webkit-box;display:-ms-flexbox;display:flex;white-space:nowrap}body #app .main-content-bs.setting-form .form-group .range-input input,body #app .main-content-bs.setting-form .input-group .range-input input,html #app .main-content-bs.setting-form .form-group .range-input input,html #app .main-content-bs.setting-form .input-group .range-input input{margin-left:.6rem;margin-right:.6rem}body #app .main-content-bs.setting-form .btns,html #app .main-content-bs.setting-form .btns{position:sticky;bottom:0;background:#fff;padding:.6rem 0;margin-top:-.6rem;z-index:10}body #app .main-content-bs.setting-form .btns .btn,html #app .main-content-bs.setting-form .btns .btn{margin-right:.6rem;margin-bottom:.6rem}body #app .chat-panel,html #app .chat-panel{overflow:hidden;background:#fff}body #app .chat-panel.wide-screen,html #app .chat-panel.wide-screen{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;padding-bottom:.6rem}body #app .chat-panel.wide-screen .chat-messages,html #app .chat-panel.wide-screen .chat-messages{margin-top:.3rem}body #app .chat-panel.wide-screen .input-area,html #app .chat-panel.wide-screen .input-area{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding-top:.3rem;padding-left:0;padding-bottom:0;height:100%;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-ms-flex-wrap:nowrap;flex-wrap:nowrap;width:33%!important;-webkit-box-flex:0;-ms-flex:none;flex:none}body #app .chat-panel.wide-screen .input-area textarea,html #app .chat-panel.wide-screen .input-area textarea{height:100%;width:100%;margin-bottom:.6rem}body #app .chat-panel,body #app .chat-panel .chat-messages,html #app .chat-panel,html #app .chat-panel .chat-messages{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}body #app .chat-panel .chat-messages,html #app .chat-panel .chat-messages{overflow:scroll;margin-top:.6rem}body #app .chat-panel .input-area,html #app .chat-panel .input-area{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;padding:.6rem;padding-top:0}body #app .chat-panel .input-area .stop-btn,html #app .chat-panel .input-area .stop-btn{position:absolute;left:0;top:0;right:0;bottom:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;backdrop-filter:blur(.06rem);z-index:10}body #app .chat-panel .input-area .stop-btn .icon,html #app .chat-panel .input-area .stop-btn .icon{margin-right:.3rem}body #app .chat-panel .input-area .enter-switch .bi,html #app .chat-panel .input-area .enter-switch .bi{-webkit-transform:rotate(180deg);transform:rotate(180deg);-webkit-transform-origin:center;transform-origin:center;display:block}body #app .chat-panel .input-area.input-group,html #app .chat-panel .input-area.input-group{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;width:100%}body,body #app .chat-panel .input-area.input-group input,html,html #app .chat-panel .input-area.input-group input{width:100%}body #app .chat-panel .input-area.input-group textarea,html #app .chat-panel .input-area.input-group textarea{width:100%;height:2.37rem;resize:none;-webkit-transition:.3s;transition:.3s;overflow:hidden}body #app .chat-panel .input-area.input-group textarea.active,html #app .chat-panel .input-area.input-group textarea.active{height:7.2rem;overflow:auto}body #app .preset-prompt,html #app .preset-prompt{white-space:break-spaces;line-height:1.6;margin-bottom:0}body #app .preset-card,html #app .preset-card{margin:0 .6rem;margin-top:0;position:sticky;top:0;z-index:10}body #app .preset-card pre,html #app .preset-card pre{margin-bottom:0;white-space:pre-wrap}body #app .preset-prompt-btn,html #app .preset-prompt-btn{white-space:nowrap}body #app .preset-prompt-btn .bi,html #app .preset-prompt-btn .bi{margin-right:.36rem}body #app .msgbox,html #app .msgbox{margin:.3rem 0;scroll-behavior:smooth;height:100%;overflow:auto}body #app .msgbox .tool-btns,html #app .msgbox .tool-btns{display:-webkit-box;display:-ms-flexbox;display:flex;white-space:nowrap}body #app .msgbox .tool-btns .btn,html #app .msgbox .tool-btns .btn{margin:0 .18rem;border-radius:100%}body #app .msgbox .function-btns,html #app .msgbox .function-btns{margin-top:.6rem;padding-bottom:.6rem;position:sticky;bottom:0}body #app .msgbox .function-btns .btn,html #app .msgbox .function-btns .btn{margin:0 .3rem}body #app .msgbox .new-ico,html #app .msgbox .new-ico{margin-right:.24rem;font-size:.72rem}body #app .msgbox .alert,html #app .msgbox .alert{margin-bottom:0}body #app .msgbox .preset-prompt,html #app .msgbox .preset-prompt{overflow:auto;white-space:break-spaces;font-size:.72rem;line-height:1.2}body #app .msgbox .text,html #app .msgbox .text{padding:.48rem;margin:0 .48rem;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-transition:.45s cubic-bezier(1,-.22,0,1.15);transition:.45s cubic-bezier(1,-.22,0,1.15);-webkit-transform:scale(0);transform:scale(0)}body #app .msgbox .text.active,html #app .msgbox .text.active{-webkit-transform:scale(1);transform:scale(1)}body #app .msgbox .text .message,html #app .msgbox .text .message{position:relative;border-radius:.3rem;padding:.48rem;white-space:normal;word-break:break-all;overflow:auto}body #app .msgbox .text .info,html #app .msgbox .text .info{position:sticky;z-index:10;top:0;left:0;backdrop-filter:blur(.18rem);background:rgba(255,255,255,.8);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden;white-space:nowrap;border-radius:.3rem;padding:.36rem .3rem;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}body #app .msgbox .text .info .user,html #app .msgbox .text .info .user{margin:0 .24rem;white-space:nowrap;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex}body #app .msgbox .text .info .user .icon,html #app .msgbox .text .info .user .icon{margin-right:.48rem;font-size:1.5rem}body #app .msgbox .text .info .user .li .name,html #app .msgbox .text .info .user .li .name{color:#333;font-size:.84rem;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin-bottom:.12rem}body #app .msgbox .text .info .user .li .time,html #app .msgbox .text .info .user .li .time{font-size:.48rem;color:#777}body #app .msgbox .text.question,html #app .msgbox .text.question{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}body #app .msgbox .text.question .message,html #app .msgbox .text.question .message{background:#eff;color:#344}body #app .msgbox .text.question .message .user-input,html #app .msgbox .text.question .message .user-input{margin:0;white-space:break-spaces}body #app .msgbox .text.answer,html #app .msgbox .text.answer{-webkit-transform-origin:left bottom;transform-origin:left bottom}body #app .msgbox .text.answer .message,html #app .msgbox .text.answer .message{background:#ffe;color:#226}body #app .msgbox .text .message,html #app .msgbox .text .message{font-size:.96rem;line-height:1.5}body #app .history-panel,html #app .history-panel{height:100%;overflow:auto}body #app .history-panel .clear-history,html #app .history-panel .clear-history{margin:0 .6rem;position:sticky;top:0;z-index:10}body #app .history-panel .msgbox,html #app .history-panel .msgbox{height:unset}body #app .history-panel .msgbox+.msgbox,html #app .history-panel .msgbox+.msgbox{border-top:.06rem solid #ccc}body .hidden-btn,html .hidden-btn{width:.6rem;height:.6rem;position:absolute;top:-6rem;left:-6rem}");modules["/src/App.jsx"](require)})();